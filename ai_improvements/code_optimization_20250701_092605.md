# Code Optimization

**File**: `./tests/test_main.py`  
**Time**: 09:26:05  
**Type**: code_optimization

## Improvement

**Improvement:**  Use a `pytest.fixture` to create and reuse the `AsyncClient` instance.

**Code:**

```python
import pytest
from httpx import AsyncClient, ASGITransport

@pytest.fixture
async def async_client():
    from app.main import app
    async with AsyncClient(transport=ASGITransport(app=app), base_url="http://test") as ac:
        yield ac

@pytest.mark.asyncio
async def test_root(async_client):
    response = await async_client.get("/")
    assert response.status_code == 200
    assert response.json() == {"message": "Product Assistant API - Ready to help you find products"}

@pytest.mark.asyncio
async def test_health(async_client):
    response = await async_client.get("/health")
    assert response.status_code == 200
    assert response.json()["status"] == "healthy"
    assert response.json()["version"] == "1.0.0"
```

**Explanation:**

The original code creates a new `AsyncClient` instance in each test function.  This is inefficient because setting up the client (importing the app, creating the transport) takes time.  By using a `pytest.fixture`, we create the `AsyncClient` *once* before any of the tests that use it are run, and then reuse that same client instance for each test. This reduces the overhead of creating and tearing down the client multiple times, leading to faster test execution, especially if you have many tests using the client.

---
*Generated by Smart AI Bot*
