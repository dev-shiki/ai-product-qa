# Error Handling Improvement

**File**: `./tests/test_config.py`  
**Time**: 03:04:12  
**Type**: error_handling_improvement

## Improvement

```python
import os
import pytest
from unittest import mock

def test_settings_valid(monkeypatch):
    monkeypatch.setenv("GOOGLE_API_KEY", "dummy-key")
    # Import after setting env
    from app.utils import config
    s = config.Settings(GOOGLE_API_KEY="dummy-key")
    assert s.GOOGLE_API_KEY == "dummy-key"
    assert s.API_PORT == 8000

def test_settings_invalid(monkeypatch):
    monkeypatch.setenv("GOOGLE_API_KEY", "your-google-api-key-here")
    from app.utils import config
    with pytest.raises(ValueError) as excinfo:
        config.Settings(GOOGLE_API_KEY="your-google-api-key-here")
    assert "Invalid API Key" in str(excinfo.value) # Example Assertion
```

**Reasoning for Improvement:**

The original `test_settings_invalid` function only asserts that a `ValueError` is raised when an invalid API key is provided.  While this confirms that *some* error handling is in place, it doesn't verify the *specific* nature of the error.  This makes the test less robust.  If the code changes to raise a `ValueError` for a different reason, this test might still pass even if the API key validation is broken.

The improved code adds an assertion within the `pytest.raises` context manager to check that the raised `ValueError`'s message contains "Invalid API Key".  This confirms that the `ValueError` is indeed being raised due to the invalid API key, making the test more specific and reliable.  This is a better practice as it verifies the expected error message and ensures that the correct validation logic is being triggered. This also makes the test easier to debug in the future, since we know exactly why the test failed.

**Explanation of Changes:**

1. **`with pytest.raises(ValueError) as excinfo:`**:  We capture the exception information in the `excinfo` variable using `as excinfo`.
2. **`assert "Invalid API Key" in str(excinfo.value)`**: This line extracts the exception message (`excinfo.value`, which is the `ValueError` instance) and converts it to a string. Then, it asserts that the string contains the phrase "Invalid API Key".  You should replace `"Invalid API Key"` with the actual error message expected from your `config.Settings` class when an invalid key is passed.

---
*Generated by Smart AI Bot*
