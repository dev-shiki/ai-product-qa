# Error Handling Improvement

**File**: `./tests/test_config.py`  
**Time**: 02:19:48  
**Type**: error_handling_improvement

## Improvement

```python
import os
import pytest
from unittest import mock

def test_settings_valid(monkeypatch):
    monkeypatch.setenv("GOOGLE_API_KEY", "dummy-key")
    # Import after setting env
    from app.utils import config
    s = config.Settings(GOOGLE_API_KEY="dummy-key")
    assert s.GOOGLE_API_KEY == "dummy-key"
    assert s.API_PORT == 8000

def test_settings_invalid(monkeypatch):
    monkeypatch.setenv("GOOGLE_API_KEY", "your-google-api-key-here")
    from app.utils import config
    with pytest.raises(ValueError) as excinfo:
        config.Settings(GOOGLE_API_KEY="your-google-api-key-here")
    assert "Invalid API Key provided." in str(excinfo.value)
```

**Reasoning for Improvement:**

The original `test_settings_invalid` test simply checked if a `ValueError` was raised when an invalid API key was provided.  While this confirms that *some* error is raised, it doesn't verify that the error message is specific to the API key being invalid.

The improved version adds a check on the `ValueError`'s message:

1. **`with pytest.raises(ValueError) as excinfo:`**:  This captures the exception information into the `excinfo` variable.
2. **`assert "Invalid API Key provided." in str(excinfo.value)`**: This line asserts that the string "Invalid API Key provided." is present within the string representation of the `ValueError` exception.

This enhancement makes the test more robust because:

*   **Specificity:** It verifies that the correct type of error *and* the correct error message are produced when an invalid API key is used.  This prevents the test from passing if some other `ValueError` is raised for an unrelated reason.
*   **Debugging:** If the test fails, the assertion message will clearly indicate that the error message related to the invalid API key is not what's expected.  This significantly simplifies debugging.

**Assumptions:**

I'm assuming that the `config.Settings` class (in the `app.utils` module) raises a `ValueError` with a message that includes "Invalid API Key provided." when the provided API key is invalid. If the actual error message is different, you would adjust the assertion accordingly. For example,  `assert "Key is too short" in str(excinfo.value)` or whatever the correct error message should be.

---
*Generated by Smart AI Bot*
