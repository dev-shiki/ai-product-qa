# Code Optimization

**File**: `./tests/test_product_data_service.py`  
**Time**: 09:43:39  
**Type**: code_optimization

## Improvement

**Optimization:** Pre-calculate `mock_products` outside the test function.

**Improvement:**

```python
...
class TestProductDataService:
    
    # Move outside the test to prevent re-creation
    MOCK_PRODUCTS = [{"id": "P001", "name": "iPhone 15 Pro Max", "price": 21999000}] 

    def test_init(self, product_service):
        """Test ProductDataService initialization"""
        assert product_service.local_service is not None
        assert isinstance(product_service.local_service, MagicMock)
    
    @pytest.mark.asyncio
    async def test_search_products_success(self, product_service, mock_local_service):
        """Test successful product search"""
        
        mock_local_service.search_products.return_value = TestProductDataService.MOCK_PRODUCTS # Use from class variable.
        
        result = await product_service.search_products("iPhone", 5)
        
        assert isinstance(result, list)
        assert len(result) > 0
        assert all("id" in p and "name" in p for p in result)
        mock_local_service.search_products.assert_called_once_with("iPhone", 5)
    ...
```

**Explanation:**

In `test_search_products_success`, the `mock_products` list is created inside the test function. This means the same list is created every time the test is run.  Since the list's content is static and doesn't depend on any test-specific parameters, we can move its creation outside the test function, creating it once at the class level as a class variable.  This avoids unnecessary object creation during test execution. While the performance gain is small in this specific case, it's a good practice for immutable or static data used repeatedly within tests, and it can become more significant when the data structures are larger or the tests are run frequently.

---
*Generated by Smart AI Bot*
