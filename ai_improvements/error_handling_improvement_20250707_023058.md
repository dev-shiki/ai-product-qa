# Error Handling Improvement

**File**: `./tests/test_config.py`  
**Time**: 02:30:58  
**Type**: error_handling_improvement

## Improvement

```python
import os
import pytest
from unittest import mock

def test_settings_valid(monkeypatch):
    monkeypatch.setenv("GOOGLE_API_KEY", "dummy-key")
    # Import after setting env
    from app.utils import config
    s = config.Settings(GOOGLE_API_KEY="dummy-key")
    assert s.GOOGLE_API_KEY == "dummy-key"
    assert s.API_PORT == 8000

def test_settings_invalid(monkeypatch):
    monkeypatch.setenv("GOOGLE_API_KEY", "your-google-api-key-here")
    from app.utils import config
    with pytest.raises(ValueError) as excinfo:
        config.Settings(GOOGLE_API_KEY="your-google-api-key-here")
    assert "Invalid Google API Key" in str(excinfo.value) #Improved assertion to check message
```

**Reasoning for Improvement:**

The original `test_settings_invalid` function simply asserts that a `ValueError` is raised when the Google API key is invalid. While this checks that *some* error occurs, it doesn't verify *what* error.  This can lead to false positives: if a different part of the `Settings` initialization raises a `ValueError` for an unrelated reason, the test would still pass, masking the actual problem.

The improved code introduces the following changes:

1. **Capture the Exception Information:** `with pytest.raises(ValueError) as excinfo:` captures the exception raised in the `excinfo` variable.
2. **Assert on the Error Message:** `assert "Invalid Google API Key" in str(excinfo.value)` checks that the `ValueError`'s message contains the specific string "Invalid Google API Key".  This makes the test much more precise.  It now ensures that the `ValueError` being raised is actually due to the invalid API key and not some other error.

This improved error handling makes the test more robust and reliable.  It confirms that the correct error is raised with the correct message, providing more confidence that the application's error handling is working as expected. It also gives a clearer indication if the test fails due to an unexpected error message, aiding in debugging.

---
*Generated by Smart AI Bot*
